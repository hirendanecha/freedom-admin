<c-card class="app-user mb-3">
  <c-card-header class="d-flex align-items-center justify-content-between"> User
    <div class="d-flex filter-table-action btn btn-outline-secondary" (click)="toggleActionColumn()">
      <span class="material-symbols-outlined">
        filter_list
        </span>
      <span>&nbsp;Filter</span>
    </div>  
  </c-card-header>

  <c-card-body>
    <c-row class="pb-3" >
      <!-- <c-col xs="3">
        <input
          cFormControl
          placeholder="Search..."
          name="search"
          [formControl]="searchCtrl"
        />
      </c-col> -->
        <app-filter (searchClick)="onSearch()"></app-filter>
    </c-row>

    <app-table>
      <thead cTableColor="light">
        <tr class="text-center align-middle">
          <th>Profile</th>
          <th>UserId</th>
          <!-- <th>ProfileId</th> -->
          <th>Firstname</th>
          <!-- <th>Lastname</th> -->
          <th>Username</th>
          <th>Email</th>
          <!-- <th>AccountType</th> -->
          <th>Phone</th>
          <th>Date Creation</th>
          <th>Country</th>
          <th>State</th>
          <th>Zip</th>
          <!-- <th>Status</th> -->
          <!-- <th>Suspended</th> -->
          <th *ngIf="showActionColumn">Action</th>
          <!-- <th>Activate Media</th> -->
        </tr>
      </thead>

      <tbody>
        <tr class="text-center align-middle" *ngFor="let user of userData; let i = index">
          <td>
            <img
              class="avatar-img"
              [src]="user.ProfilePicName"
              onerror="this.onerror=null;this.src='/assets/img/avatars/placeholder-user.png';"
            />
          </td>
          <td>
            {{ user.Id }}
          </td>
          <!-- <td>
            {{ user.profileId || "-" }}
          </td> -->
          <td>
            {{ user.FirstName || "-" }}
          </td>
          <!-- <td>
            {{ user.LastName || "-" }}
          </td> -->

          <td>{{ user.Username || "-" }}</td>
          <td>
            {{ user.Email || "-" }}
          </td>
          <td>
            {{ user.MobileNo || "-" }}
          </td>
          <td>{{ user.DateCreation | date : "d-MM-YYYY" }}</td>
          <td>
            <svg
              *ngIf="user.Country"
              cIcon
              id="{{ user.Country }}"
              name="cif-{{ user?.Country || null | lowercase }}"
              size="xl"
              title="{{ user?.Country }}"
            ></svg>
            <span *ngIf="!user.Country">{{ "-" }}</span>
          </td>
          <td>{{ user.State || "-" }}</td>
          <td>{{ user.Zip || "-" }}</td>
          <td *ngIf="showActionColumn">
            <tr>
            <button
              class="btn btn-sm text-white m-1 custom-btn"
              size="sm"
              [ngClass]="
                user.IsSuspended === 'N' ? ' btn-danger' : 'btn-success'
              "
              (click)="
                suspendUser(user.Id, user.IsSuspended === 'N' ? 'Y' : 'N')
              "
            >
              {{ user.IsSuspended === "N" ? "Suspend" : "Re-active" }}
            </button>
            <button
              class="btn btn-sm text-white m-1 custom-btn"
              size="sm"
              [ngClass]="
                user.MediaApproved === 0 || user.MediaApproved === null
                  ? 'btn-success'
                  : 'btn-danger'
              "
              (click)="
                changeMediaType(
                  user.profileId,
                  user.MediaApproved === 0 || user.MediaApproved === null
                    ? 1
                    : 0
                )
              "
            >
              {{
                user.MediaApproved === 0 || user.MediaApproved === null
                  ? "Activate Media"
                  : "De-activate"
              }}
            </button>
            <button
              class="btn btn-sm btn-info text-white m-1 custom-btn"
              size="sm"
              (click)="openEditUserPopup(user.profileId)"
            >
              View Post
              <!-- <svg cIcon name="cilLowVision" size="md"></svg> -->
              <!-- <i class="material-symbols-outlined"> visibility </i> -->
            </button>

            <button
              class="btn btn-sm btn-info m-1 custom-btn text-white"
              size="sm"
              (click)="deleteUser(user.Id)"
            >
              Delete All Data
              <!-- <svg cIcon name="cil-trash" size="md"></svg> -->
              <!-- <i class="material-symbols-outlined"> delete </i> -->
            </button>
          </tr>
          </td>
          <!-- <td>
            
          </td> -->
        </tr>
      </tbody>

      <h6 *ngIf="!userData.length" class="text-center align-middle p-5 m-0">
        No User available
      </h6>
    </app-table>
    <app-pagination
      [items]="pagination?.totalItems"
      (onPageChange)="onPageChange($event)"
    />
    <c-toaster [placement]="'top-end'" class="p-3" position="fixed">
      <c-toast
        (timer)="onTimerChange($event)"
        (visibleChange)="onVisibleChange($event)"
        [visible]="visible"
        class="text-bg-{{ type }}"
      >
        <c-toast-header>
          <toast-sample-icon></toast-sample-icon>
        </c-toast-header>
        <c-toast-body>
          <p class="text-white">{{ message }}</p>
          <c-progress thin>
            <c-progress-bar [value]="percentage"></c-progress-bar>
          </c-progress>
        </c-toast-body>
      </c-toast>
    </c-toaster>
  </c-card-body>
</c-card>
